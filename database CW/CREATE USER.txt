CREATE USER chewan IDENTIFIED BY 23056535; 
GRANT CONNECT, RESOURCE TO Chewan;
CONNECT Chewan/23056535;
SET LINESIZE 100;


CREATE TABLE Program (
    Program_Id NUMBER(10) PRIMARY KEY NOT NULL,
    Program_Name CHARACTER(15) NOT NULL,
    Faculty CHARACTER(30) NOT NULL
);
DESC Program;
CREATE TABLE Module (
    Module_Id NUMBER(10) PRIMARY KEY NOT NULL,
    Module_Name CHARACTER(25) NOT NULL,
    Credit_Hour NUMBER(12) NOT NULL
);
DESC Module;
CREATE TABLE Teacher (
    Teacher_Id NUMBER(10) PRIMARY KEY NOT NULL,
    Teacher_Name CHARACTER(20) NOT NULL,
    Teacher_Contact CHARACTER(15) NOT NULL,
    Teacher_Address CHARACTER(20) NOT NULL
);
DESC Teacher;
CREATE TABLE Resources (
    Resource_Id NUMBER(12) PRIMARY KEY NOT NULL,
    Resource_Type CHARACTER(20) NOT NULL,
    Duration CHARACTER(10) NOT NULL
);
DESC Resources;
CREATE TABLE Assessment (
    Assessment_Id NUMBER(15) PRIMARY KEY NOT NULL,
    Assessment_Title CHARACTER(20) NOT NULL,
    Weightage CHARACTER(10) NOT NULL,
    Status CHARACTER(10) NOT NULL,
    Release DATE NOT NULL,
    Deadline DATE NOT NULL
);
DESC Assessment;
CREATE TABLE Notice (
    Notice_id NUMBER(10) PRIMARY KEY NOT NULL,
    Notice_Title CHARACTER(20) NOT NULL,
    Publish_on DATE NOT NULL
);
DESC Notice;
CREATE TABLE Result (
    Result_Id NUMBER(10) PRIMARY KEY NOT NULL,
    result_status CHARACTER(15) NOT NULL,
    Total_Marks_Obtained NUMBER(3) NOT NULL
);
DESC Result;
CREATE TABLE Student (
    Student_ID NUMBER(10) PRIMARY KEY NOT NULL,
    Program_Id NUMBER(10) REFERENCES Program(Program_Id),
    Student_Name CHARACTER(20) NOT NULL,
    Student_Contact CHARACTER(15) UNIQUE NOT NULL,
    Student_Address CHARACTER(20) NOT NULL,
    Enrolled DATE NOT NULL
);
DESC Student;
CREATE TABLE Student_Module (
    Student_ID NUMBER(10) NOT NULL,
    Module_Id NUMBER(10) NOT NULL,
    PRIMARY KEY (Student_ID, Module_Id),
    FOREIGN KEY (Student_ID) REFERENCES Student(Student_ID),
    FOREIGN KEY (Module_Id) REFERENCES Module(Module_Id)
);
DESC Student_Module;
CREATE TABLE Student_Module_Resources (
    Student_ID NUMBER(10) NOT NULL,
    Module_Id NUMBER(10) NOT NULL,
    Resource_Id NUMBER(12) NOT NULL,
    PRIMARY KEY (Student_ID, Module_Id, Resource_Id),
    FOREIGN KEY (Student_ID) REFERENCES Student(Student_ID),
    FOREIGN KEY (Module_Id) REFERENCES Module(Module_Id),
    FOREIGN KEY (Resource_Id) REFERENCES Resources(Resource_Id)
);
DESC Student_Module_Resources;
CREATE TABLE Student_Module_Teacher (
    Student_ID NUMBER(10) NOT NULL,
    Module_Id NUMBER(10) NOT NULL,
    Teacher_Id NUMBER(10) NOT NULL,
    PRIMARY KEY (Student_ID, Module_Id, Teacher_Id),
    FOREIGN KEY (Student_ID) REFERENCES Student(Student_ID),
    FOREIGN KEY (Module_Id) REFERENCES Module(Module_Id),
    FOREIGN KEY (Teacher_Id) REFERENCES Teacher(Teacher_Id)
);
DESC Student_Module_Teacher;
CREATE TABLE Student_Module_Teacher_Notice (
    Student_ID NUMBER(10) NOT NULL,
    Module_Id NUMBER(10) NOT NULL,
    Teacher_Id NUMBER(10) NOT NULL,
    Notice_id NUMBER(10) NOT NULL,
    PRIMARY KEY (Student_ID, Module_Id, Teacher_Id, Notice_id),
    FOREIGN KEY (Student_ID) REFERENCES Student(Student_ID),
    FOREIGN KEY (Module_Id) REFERENCES Module(Module_Id),
    FOREIGN KEY (Teacher_Id) REFERENCES Teacher(Teacher_Id),
    FOREIGN KEY (Notice_id) REFERENCES Notice(Notice_id)
);
DESC Student_Module_Teacher_Notice;
CREATE TABLE Student_Module_Assessment (
    Student_ID NUMBER(10) NOT NULL,
    Module_Id NUMBER(10) NOT NULL,
    Assessment_Id NUMBER(15) NOT NULL,
    Result_Id NUMBER(7) NOT NULL,
    PRIMARY KEY (Student_ID, Module_Id, Assessment_Id),
    FOREIGN KEY (Student_ID) REFERENCES Student(Student_ID),
    FOREIGN KEY (Module_Id) REFERENCES Module(Module_Id),
    FOREIGN KEY (Assessment_Id) REFERENCES Assessment(Assessment_Id),
    FOREIGN KEY (Result_Id) REFERENCES Result(Result_Id)
);
DESC Student_Module_Assessment;
SELECT*FROM TAB;

INSERT INTO Program (Program_Id, Program_Name, Faculty) VALUES (10001, 'Computing', 'IT');
INSERT INTO Program (Program_Id, Program_Name, Faculty) VALUES (10002, 'Networking', 'IT');
INSERT INTO Program (Program_Id, Program_Name, Faculty) VALUES (10003, 'Multimedia', 'IT');
INSERT INTO Program (Program_Id, Program_Name, Faculty) VALUES (10004, 'BBM', 'Management');
INSERT INTO Program (Program_Id, Program_Name, Faculty) VALUES (10005, 'BSW', 'Management');
INSERT INTO Program (Program_Id, Program_Name, Faculty) VALUES (10006, 'BBS', 'Management');
INSERT INTO Program (Program_Id, Program_Name, Faculty) VALUES (10007, 'BBA', 'Management');
SELECT * FROM Program;
INSERT INTO Module (Module_Id, Module_Name, Credit_Hour) VALUES (10001, 'Databases', 4);
INSERT INTO Module (Module_Id, Module_Name, Credit_Hour) VALUES (10002, 'Data Structures', 3);
INSERT INTO Module (Module_Id, Module_Name, Credit_Hour) VALUES (10003, 'Networking Fundamentals', 3);
INSERT INTO Module (Module_Id, Module_Name, Credit_Hour) VALUES (10004, 'Operating Systems', 4);
INSERT INTO Module (Module_Id, Module_Name, Credit_Hour) VALUES (10005, 'Software Engineering', 4);
INSERT INTO Module (Module_Id, Module_Name, Credit_Hour) VALUES (10006, 'Web Development', 3);
INSERT INTO Module (Module_Id, Module_Name, Credit_Hour) VALUES (10007, 'Artificial Intelligence', 4);
SELECT * FROM Module;
INSERT INTO Teacher (Teacher_Id, Teacher_Name, Teacher_Contact, Teacher_Address) VALUES (10001, 'Dr. Ramesh Adhikari', '9800001001', 'Kathmandu');
INSERT INTO Teacher (Teacher_Id, Teacher_Name, Teacher_Contact, Teacher_Address) VALUES (10002, 'Prof. Sushila Karki', '9800001002', 'Lalitpur');
INSERT INTO Teacher (Teacher_Id, Teacher_Name, Teacher_Contact, Teacher_Address) VALUES (10003, 'Dr. Binod Shrestha', '9800001003', 'Bhaktapur');
INSERT INTO Teacher (Teacher_Id, Teacher_Name, Teacher_Contact, Teacher_Address) VALUES (10004, 'Prof. Anju Sharma', '9800001004', 'Kathmandu');
INSERT INTO Teacher (Teacher_Id, Teacher_Name, Teacher_Contact, Teacher_Address) VALUES (10005, 'Dr. Prakash Thapa', '9800001005', 'Lalitpur');
INSERT INTO Teacher (Teacher_Id, Teacher_Name, Teacher_Contact, Teacher_Address) VALUES (10006, 'Prof. Meera Singh', '9800001006', 'Bhaktapur');
INSERT INTO Teacher (Teacher_Id, Teacher_Name, Teacher_Contact, Teacher_Address) VALUES (10007, 'Dr. Sunil Joshi', '9800001007', 'Kathmandu');
SELECT * FROM Teacher;
INSERT INTO Resources (Resource_Id, Resource_Type, Duration) VALUES (10001, 'Type 1', '2 hours');
INSERT INTO Resources (Resource_Id, Resource_Type, Duration) VALUES (10002, 'Type 2', '1 hour');
INSERT INTO Resources (Resource_Id, Resource_Type, Duration) VALUES (10003, 'Type 3', '5 hours');
INSERT INTO Resources (Resource_Id, Resource_Type, Duration) VALUES (10004, 'Type 2', '30 mins');
INSERT INTO Resources (Resource_Id, Resource_Type, Duration) VALUES (10005, 'Type 3', '3 hours');
INSERT INTO Resources (Resource_Id, Resource_Type, Duration) VALUES (10006, 'Type 1', '1.5 hrs');
INSERT INTO Resources (Resource_Id, Resource_Type, Duration) VALUES (10007, 'Type 2', '2.5 hrs');
SELECT * FROM Resources;
INSERT INTO Assessment (Assessment_Id, Assessment_Title, Weightage, Status, Release, Deadline) VALUES (10001, 'Test 1', '30', 'Completed', TO_DATE('2024-04-01', 'YYYY-MM-DD'), TO_DATE('2024-04-15', 'YYYY-MM-DD'));
INSERT INTO Assessment (Assessment_Id, Assessment_Title, Weightage, Status, Release, Deadline) VALUES (10002, 'Test 2', '70', 'Missed', TO_DATE('2024-05-01', 'YYYY-MM-DD'), TO_DATE('2024-05-30', 'YYYY-MM-DD'));
INSERT INTO Assessment (Assessment_Id, Assessment_Title, Weightage, Status, Release, Deadline) VALUES (10003, 'Coursework 1', '10', 'Submitted', TO_DATE('2024-03-01', 'YYYY-MM-DD'), TO_DATE('2024-03-05', 'YYYY-MM-DD'));
INSERT INTO Assessment (Assessment_Id, Assessment_Title, Weightage, Status, Release, Deadline) VALUES (10004, 'Coursework 2', '10', 'Missed', TO_DATE('2024-03-15', 'YYYY-MM-DD'), TO_DATE('2024-03-20', 'YYYY-MM-DD'));
INSERT INTO Assessment (Assessment_Id, Assessment_Title, Weightage, Status, Release, Deadline) VALUES (10005, 'Test 1', '20', 'Missed', TO_DATE('2024-04-10', 'YYYY-MM-DD'), TO_DATE('2024-04-20', 'YYYY-MM-DD'));
INSERT INTO Assessment (Assessment_Id, Assessment_Title, Weightage, Status, Release, Deadline) VALUES (10006, 'Test 2', '50', 'Completed', TO_DATE('2024-05-10', 'YYYY-MM-DD'), TO_DATE('2024-05-25', 'YYYY-MM-DD'));
INSERT INTO Assessment (Assessment_Id, Assessment_Title, Weightage, Status, Release, Deadline) VALUES (10007, 'Coursework 1', '30', 'Submitted', TO_DATE('2024-04-05', 'YYYY-MM-DD'), TO_DATE('2024-04-10', 'YYYY-MM-DD'));
SELECT * FROM Assessment;
INSERT INTO Notice (Notice_id, Notice_Title, Publish_on) VALUES (1000001, 'Exam Schedule', TO_DATE('2024-05-10', 'YYYY-MM-DD'));
INSERT INTO Notice (Notice_id, Notice_Title, Publish_on) VALUES (1000002, 'Assignment Deadline', TO_DATE('2024-05-15', 'YYYY-MM-DD'));
INSERT INTO Notice (Notice_id, Notice_Title, Publish_on) VALUES (1000003, 'Holiday Notice', TO_DATE('2024-05-20', 'YYYY-MM-DD'));
INSERT INTO Notice (Notice_id, Notice_Title, Publish_on) VALUES (1000004, 'Workshop Notice', TO_DATE('2024-05-25', 'YYYY-MM-DD'));
INSERT INTO Notice (Notice_id, Notice_Title, Publish_on) VALUES (1000005, 'Seminar Invitation', TO_DATE('2024-05-05', 'YYYY-MM-DD'));
INSERT INTO Notice (Notice_id, Notice_Title, Publish_on) VALUES (1000006, 'Project Submission', TO_DATE('2024-05-18', 'YYYY-MM-DD'));
INSERT INTO Notice (Notice_id, Notice_Title, Publish_on) VALUES (1000007, 'Guest Lecture', TO_DATE('2024-05-28', 'YYYY-MM-DD'));
SELECT*FROM Notice;
INSERT INTO Result (Result_Id, result_status, Total_Marks_Obtained) VALUES (10001, 'Passed', 85);
INSERT INTO Result (Result_Id, result_status, Total_Marks_Obtained) VALUES (10002, 'Failed', 35);
INSERT INTO Result (Result_Id, result_status, Total_Marks_Obtained) VALUES (10003, 'Passed', 75);
INSERT INTO Result (Result_Id, result_status, Total_Marks_Obtained) VALUES (10004, 'Failed', 20);
INSERT INTO Result (Result_Id, result_status, Total_Marks_Obtained) VALUES (10005, 'Passed', 90);
INSERT INTO Result (Result_Id, result_status, Total_Marks_Obtained) VALUES (10006, 'Failed', 20);
INSERT INTO Result (Result_Id, result_status, Total_Marks_Obtained) VALUES (10007, 'Passed', 65);
SELECT * FROM Result;
INSERT INTO Student (Student_ID, Program_Id, Student_Name, Student_Contact, Student_Address, Enrolled) VALUES (2394740, 10001, 'Ram Shrestha', '9800000001', 'Kathmandu', TO_DATE('2024-01-15', 'YYYY-MM-DD'));
INSERT INTO Student (Student_ID, Program_Id, Student_Name, Student_Contact, Student_Address, Enrolled) VALUES (2394741, 10002, 'Sita Tamang', '9800000002', 'Lalitpur', TO_DATE('2024-01-20', 'YYYY-MM-DD'));
INSERT INTO Student (Student_ID, Program_Id, Student_Name, Student_Contact, Student_Address, Enrolled) VALUES (2394742, 10003, 'Hari Bahadur', '9800000003', 'Bhaktapur', TO_DATE('2024-02-10', 'YYYY-MM-DD'));
INSERT INTO Student (Student_ID, Program_Id, Student_Name, Student_Contact, Student_Address, Enrolled) VALUES (2394743, 10004, 'Gita Rai', '9800000004', 'Kathmandu', TO_DATE('2024-03-05', 'YYYY-MM-DD'));
INSERT INTO Student (Student_ID, Program_Id, Student_Name, Student_Contact, Student_Address, Enrolled) VALUES (2394744, 10005, 'Krishna Gurung', '9800000005', 'Lalitpur', TO_DATE('2024-04-12', 'YYYY-MM-DD'));
INSERT INTO Student (Student_ID, Program_Id, Student_Name, Student_Contact, Student_Address, Enrolled) VALUES (2394745, 10006, 'Radha Magar', '9800000006', 'Bhaktapur', TO_DATE('2024-05-18', 'YYYY-MM-DD'));
INSERT INTO Student (Student_ID, Program_Id, Student_Name, Student_Contact, Student_Address, Enrolled) VALUES (2394746, 10007, 'Bishnu Thapa', '9800000007', 'Kathmandu', TO_DATE('2024-06-25', 'YYYY-MM-DD'));
SELECT * FROM Student;
INSERT INTO Student_Module (Student_ID, Module_Id) VALUES (2394740, 10001);
INSERT INTO Student_Module (Student_ID, Module_Id) VALUES (2394741, 10002);
INSERT INTO Student_Module (Student_ID, Module_Id) VALUES (2394742, 10003);
INSERT INTO Student_Module (Student_ID, Module_Id) VALUES (2394743, 10004);
INSERT INTO Student_Module (Student_ID, Module_Id) VALUES (2394744, 10005);
INSERT INTO Student_Module (Student_ID, Module_Id) VALUES (2394745, 10006);
INSERT INTO Student_Module (Student_ID, Module_Id) VALUES (2394746, 10007);
SELECT * FROM Student_Module;
INSERT INTO Student_Module_Resources (Student_ID, Module_Id, Resource_Id) VALUES (2394740, 10001, 10001);
INSERT INTO Student_Module_Resources (Student_ID, Module_Id, Resource_Id) VALUES (2394741, 10002, 10002);
INSERT INTO Student_Module_Resources (Student_ID, Module_Id, Resource_Id) VALUES (2394742, 10003, 10003);
INSERT INTO Student_Module_Resources (Student_ID, Module_Id, Resource_Id) VALUES (2394743, 10004, 10004);
INSERT INTO Student_Module_Resources (Student_ID, Module_Id, Resource_Id) VALUES (2394744, 10005, 10005);
INSERT INTO Student_Module_Resources (Student_ID, Module_Id, Resource_Id) VALUES (2394745, 10006, 10006);
INSERT INTO Student_Module_Resources (Student_ID, Module_Id, Resource_Id) VALUES (2394746, 10007, 10007);
SELECT * FROM Student_Module_Resources;
INSERT INTO Student_Module_Teacher (Student_ID, Module_Id, Teacher_Id) VALUES (2394740, 10001, 10001);
INSERT INTO Student_Module_Teacher (Student_ID, Module_Id, Teacher_Id) VALUES (2394741, 10002, 10002);
INSERT INTO Student_Module_Teacher (Student_ID, Module_Id, Teacher_Id) VALUES (2394742, 10003, 10003);
INSERT INTO Student_Module_Teacher (Student_ID, Module_Id, Teacher_Id) VALUES (2394743, 10004, 10004);
INSERT INTO Student_Module_Teacher (Student_ID, Module_Id, Teacher_Id) VALUES (2394744, 10005, 10005);
INSERT INTO Student_Module_Teacher (Student_ID, Module_Id, Teacher_Id) VALUES (2394745, 10006, 10006);
INSERT INTO Student_Module_Teacher (Student_ID, Module_Id, Teacher_Id) VALUES (2394746, 10007, 10007);
SELECT * FROM Student_Module_Teacher;
INSERT INTO Student_Module_Assessment (Student_ID, Module_Id, Assessment_Id, Result_Id) VALUES (2394740, 10001, 10001, 10001);
INSERT INTO Student_Module_Assessment (Student_ID, Module_Id, Assessment_Id, Result_Id) VALUES (2394741, 10002, 10002, 10002);
INSERT INTO Student_Module_Assessment (Student_ID, Module_Id, Assessment_Id, Result_Id) VALUES (2394742, 10003, 10003, 10003);
INSERT INTO Student_Module_Assessment (Student_ID, Module_Id, Assessment_Id, Result_Id) VALUES (2394743, 10004, 10004, 10004);
INSERT INTO Student_Module_Assessment (Student_ID, Module_Id, Assessment_Id, Result_Id) VALUES (2394744, 10005, 10005, 10005);
INSERT INTO Student_Module_Assessment (Student_ID, Module_Id, Assessment_Id, Result_Id) VALUES (2394745, 10006, 10006, 10006);
INSERT INTO Student_Module_Assessment (Student_ID, Module_Id, Assessment_Id, Result_Id) VALUES (2394746, 10007, 10007, 10007);
SELECT * FROM Student_Module_Assessment;
INSERT INTO Student_Module_Teacher_Notice (Student_ID, Module_Id, Teacher_Id, Notice_id) VALUES (2394740, 10001, 10001, 1000001);
INSERT INTO Student_Module_Teacher_Notice (Student_ID, Module_Id, Teacher_Id, Notice_id) VALUES (2394741, 10002, 10002, 1000002);
INSERT INTO Student_Module_Teacher_Notice (Student_ID, Module_Id, Teacher_Id, Notice_id) VALUES (2394742, 10003, 10003, 1000003);
INSERT INTO Student_Module_Teacher_Notice (Student_ID, Module_Id, Teacher_Id, Notice_id) VALUES (2394743, 10004, 10004, 1000004);
INSERT INTO Student_Module_Teacher_Notice (Student_ID, Module_Id, Teacher_Id, Notice_id) VALUES (2394744, 10005, 10005, 1000005);
INSERT INTO Student_Module_Teacher_Notice (Student_ID, Module_Id, Teacher_Id, Notice_id) VALUES (2394745, 10006, 10006, 1000006);
INSERT INTO Student_Module_Teacher_Notice (Student_ID, Module_Id, Teacher_Id, Notice_id) VALUES (2394746, 10007, 10007, 1000007);
SELECT * FROM Student_Module_Teacher_Notice;
COMMIT;


 1. List the programs that are available in the college and the total number of students
 enrolled in each.
SELECT 
    p.Program_Name,
    COUNT(s.Student_ID) AS Total_Students
FROM 
    Program p
LEFT JOIN 
    Student s ON p.Program_Id = s.Program_Id
GROUP BY 
    p.Program_Name;


2. List all the announcements made for a particular module starting from 1st May 2024 to
 28th May 2024.

SELECT n.Notice_Title, n.Publish_on
FROM Notice n
JOIN Student_Module_Teacher_Notice smtn ON n.Notice_id = smtn.Notice_id
WHERE smtn.Module_Id = 10001
  AND n.Publish_on BETWEEN TO_DATE('2024-05-01', 'YYYY-MM-DD') AND TO_DATE('2024-05-28', 'YYYY-MM-DD');


3. List the names of all modules that begin with the letter 'D', along with the total number of
 resources uploaded for those modules.

SELECT m.Module_Name, COUNT(r.Resource_Id) AS Total_Resources
FROM Module m
LEFT JOIN Student_Module_Resources smr ON m.Module_Id = smr.Module_Id
LEFT JOIN Resources r ON smr.Resource_Id = r.Resource_Id
WHERE m.Module_Name LIKE 'D%'
GROUP BY m.Module_Name;


4. List the names of all students along with their enrolled program who have not submitted any assessments for a particular module.

SELECT s.Student_Name, p.Program_Name
FROM Student s
JOIN Program p ON s.Program_Id = p.Program_Id
LEFT JOIN Student_Module_Assessment sma ON s.Student_ID = sma.Student_ID AND sma.Module_Id = 10001
WHERE sma.Assessment_Id IS NULL;

5. List all the teachers who teach more than one module.
SELECT t.Teacher_Name
FROM Teacher t
JOIN Student_Module_Teacher smt ON t.Teacher_Id = smt.Teacher_Id
GROUP BY t.Teacher_Name
HAVING COUNT(DISTINCT smt.Module_Id) > 1;


 Transaction query (15 Marks)
1. Identify the module that has the latest assessment deadline.
SELECT m.Module_Name, a.Deadline
FROM Module m
JOIN Student_Module_Assessment sma ON m.Module_Id = sma.Module_Id
JOIN Assessment a ON sma.Assessment_Id = a.Assessment_Id
WHERE a.Deadline = (
    SELECT MAX(Deadline)
    FROM Assessment
);



2. Find the top three students who have the highest total score across all modules.

SELECT Student_Name, Total_Score
FROM (
    SELECT s.Student_Name, SUM(r.Total_Marks_Obtained) AS Total_Score
    FROM Student s
    JOIN Student_Module_Assessment sma ON s.Student_ID = sma.Student_ID
    JOIN Result r ON sma.Result_Id = r.Result_Id
    GROUP BY s.Student_Name
    ORDER BY Total_Score DESC
)
WHERE ROWNUM <= 3;

3. Find the total number of assessments for each program and the average score across all assessments in those programs.
SELECT p.Program_Name, 
       COUNT(a.Assessment_Id) AS Total_Assessments, 
       AVG(r.Total_Marks_Obtained) AS Average_Score
FROM Program p
JOIN Student s ON p.Program_Id = s.Program_Id
JOIN Student_Module_Assessment sma ON s.Student_ID = sma.Student_ID
JOIN Assessment a ON sma.Assessment_Id = a.Assessment_Id
JOIN Result r ON sma.Result_Id = r.Result_Id
GROUP BY p.Program_Name;

4. List the students who have scored above the average score in the ‘Databases’ module.
SELECT s.Student_Name, r.Total_Marks_Obtained
FROM Student s
JOIN Student_Module_Assessment sma ON s.Student_ID = sma.Student_ID
JOIN Result r ON sma.Result_Id = r.Result_Id
JOIN Module m ON sma.Module_Id = m.Module_Id
WHERE m.Module_Name = 'Databases'
  AND r.Total_Marks_Obtained > (
    SELECT AVG(r2.Total_Marks_Obtained)
    FROM Student_Module_Assessment sma2
    JOIN Result r2 ON sma2.Result_Id = r2.Result_Id
    JOIN Module m2 ON sma2.Module_Id = m2.Module_Id
    WHERE m2.Module_Name = 'Databases'
);

5. Display whether a student has passed or failed as remarks as per their total aggregate
 marks obtained in a particular module. (NOTE: Consider total aggregate marks equal
 to or above 40 is pass , below 40 is fail)
COLUMN Remarks FORMAT A7
SELECT s.Student_Name, m.Module_Name, r.Total_Marks_Obtained,
       CASE
           WHEN r.Total_Marks_Obtained >= 40 THEN 'Pass'
           ELSE 'Fail'
       END AS Remarks
FROM Student s
JOIN Student_Module_Assessment sma ON s.Student_ID = sma.Student_ID
JOIN Result r ON sma.Result_Id = r.Result_Id
JOIN Module m ON sma.Module_Id = m.Module_Id
WHERE m.Module_Name = 'Databases';


DROP TABLE Student_Module_Teacher_Notice;
DROP TABLE Student_Module_Assessment;
DROP TABLE Student_Module_Teacher;
DROP TABLE Student_Module_Resources;
DROP TABLE Student_Module;
DROP TABLE Result;
DROP TABLE Notice;
DROP TABLE Assessment;
DROP TABLE Resources;
DROP TABLE Teacher;
DROP TABLE Module;
DROP TABLE Student;
DROP TABLE Program;